# 循环冗余校验

## 基本原理

> 发送方在P位二进制信息帧序列后附加一个R位二进制校验码帧序列,从而构成一个总长为N=P+R的二进制帧序列,R与P之前存在某种特定关系,如果数据被篡改,这种特定关系将被破坏,所以接收端可通过检查这一关系实现对数据正确性校验.

## 校验流程

### 客户端

* 将待传输的数据用二进制形式展开
* 选定生成多项式
* 将展开的二进制形式后补选定的生成多项式的二进制形式长度个0
* 用补0后的数据的二进制模二除选定的生成多项式的二进制,得到的余数既为CRC校验码
* 将待传输的数据二进制后附加二进制帧校验码发送给服务端

### 服务端

* 选定生成多项式
* 用客户端发送的携带CRC校验码的数据二进制模二除选定的生成多项式的二进制,如果可以整除则CRC验证通过

## 相关概念

### 模二运算

一种二进制算法,是CRC校验核心.与四则运算相同的是模二运算也包括模二加,模二减,模二乘,模二除,但不同的是模二运算不考虑进位和借位.

```bash
# 算术除法
示例: 120 / 9 = 13 余 3, 120是被除数, 9是除数, 13是商, 3是余数

# 模二除法
规律: 同为0, 异为1
示例:
              1 1 1 0     # 14(1110)商
          -------------
1 0 0 1 / 1 1 1 1 0 0 0   # 120(1111000)是被除数, 9(1001)是除数
         |1 0 0 1
         |---------
         |  1 1 0 0 0 0
         |  1 0 0 1
         |---------
         |    1 0 1 0 0
         |    1 0 0 1
         |---------
         |        1 1 0   # 6(110)是余数
```

### [生成多项式]()

CRC校验的前提是客户端和服务端事先约定一个模二除法中的除数(生成多项式),除数的最高位与最低位必须是1,每一个多项式都与一个二进制除数对应,如CRC-8表示100110001,生成多项式主要用于降低校验出错率

